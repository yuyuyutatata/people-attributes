<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>来客属性カウンター（初回のみカウント・DB照合）</title>
  <style>
    body{font-family:system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";margin:0;padding:16px;background:#fafafa;color:#222}
    header{display:flex;gap:8px;align-items:center;margin-bottom:8px}
    button,input[type="checkbox"]{font-size:14px}
    .wrap{display:grid;grid-template-columns:1fr 420px;gap:16px;align-items:start}
    #overlay{width:100%;max-width:100%;background:#000;border-radius:8px}
    .panel{background:#fff;border:1px solid #eee;border-radius:10px;box-shadow:0 1px 2px rgba(0,0,0,.04)}
    .panel h2{margin:0;padding:12px 16px;border-bottom:1px solid #eee;font-size:20px;display:flex;align-items:center;gap:12px}
    .panel .body{padding:12px 16px}
    table{width:100%;border-collapse:collapse;font-size:14px}
    th,td{border:1px solid #eee;padding:8px;text-align:center}
    th{background:#fafafa}
    .muted{color:#666;font-size:12px;margin-top:6px}
    .btn{padding:6px 10px;border:1px solid #ddd;background:#fff;border-radius:6px;cursor:pointer}
    .btn:disabled{opacity:.6;cursor:not-allowed}
    .btn-danger{background:#ff6363;color:#fff;border:none;border-radius:6px;padding:6px 10px;cursor:pointer}
    #status{margin-left:8px;color:#666}
  </style>
  <!-- Human.js -->
  <script defer src="https://cdn.jsdelivr.net/npm/@vladmandic/human@3.3.6/dist/human.js"></script>
  <script defer src="./main.js"></script>
</head>
<body>
  <header>
    <button id="btnStart" class="btn">カメラ開始</button>
    <button id="btnStop"  class="btn" disabled>停止</button>
    <button id="btnCsv"   class="btn">CSVダウンロード</button>
    <label style="margin-left:8px"><input type="checkbox" id="ckFront"> 前面カメラを使う</label>
    <span id="status">モデル準備中…</span>
  </header>

  <div class="wrap">
    <canvas id="overlay" width="640" height="480" class="panel"></canvas>

    <section class="panel">
      <h2>
        集計（初回のみ加算）
        <button id="btnResetAll" class="btn-danger" style="margin-left:auto">DB含む全リセット</button>
      </h2>
      <div class="body">
        <table>
          <thead>
            <tr><th>年齢層</th><th>男性</th><th>女性</th><th>不確実</th></tr>
          </thead>
        <tbody id="tbody"></tbody>
        </table>
        <div class="muted">※ 同一人物は**一生で一度だけ**加算。以後は何度来店してもカウントしません。</div>
      </div>
    </section>
  </div>
</body>
</html>
